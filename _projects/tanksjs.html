---
permalink: /projects/tanks-js
---
<!DOCTYPE html><html><head><title>Tanks JS</title><meta charset="utf-8" name="viewport" content="width=device-width initial-scale=1"/><meta property="og:title" content="Tanks JS"/><meta name="description" content="A two-player game using the same keyboard; blow up your opponent's tank more times to win, but watch out for ricochet! Based on the game Battle Tanks from Triple Action by Mattel Electronics."/><meta property="og:description" content="A two-player game using the same keyboard; blow up your opponent's tank more times to win, but watch out for ricochet! Based on the game Battle Tanks from Triple Action by Mattel Electronics."/><meta property="og:image" content="{{ "/imgs/tanks-js.jpg" | prepend: site.url }}"/><meta property="og:image:alt" content="Gameplay screenshot of a red and yellow tank squaring off"/><meta property="og:url" content="{{ "/projects/tanks-js" | prepend: site.url }}"/><meta property="og:type" content="website"/><link rel="icon" type="image/png" href="{{ "/imgs/tanks-icon.png" | prepend: site.baseurl }}"/><style type="text/css">@font-face{font-family:'Intellect';src:url('{{ "/fonts/intellect.ttf" | prepend: site.baseurl }}');}body{background:#742;text-align:center;padding:0;margin:0;}.hide{position:absolute !important;padding:0 !important;margin:-1px !important;width:1px !important;height:1px !important;left:0 !important;top:0 !important;right:0 !important;bottom:0 !important;clip:rect(0 0 0 0);overflow:hidden;}.debug{position:absolute;border:1px solid red;right:0;top:0;}#canvas-wrapper{margin:0 auto;height:100vh;}#canvas{background:#000;width:800px;height:640px;}#canvas table{background:#000;color:#FFF;font:bold 1em/1.2em Helvetica;letter-spacing:1px;border-collapse:collapse;margin:16px auto;}#canvas caption,#canvas th,#canvas td{background:#000;border:1px solid #FFF;padding:1em;}#canvas td{padding:0.5em 1em;}.controls{color:#FFF;font-family:Courier, monospace;text-align:left;text-shadow:1px -2px 1px black, -1px 1px 1px #AAA;padding:0 24px;width:360px;}input[type="checkbox"]{display:none;}input[type="checkbox"] + label{cursor:pointer;display:block;font-size:24px;padding-left:26px;position:relative;margin:0 0 64px;}input[type="checkbox"] + label:before{background:#333;border:2px solid #FFF;border-radius:100%;box-sizing:border-box;content:'';height:18px;left:0;position:absolute;top:2px;width:18px;}input[type="checkbox"] + label:after{background:radial-gradient(circle at center, #F51 25%, #333 100%);border-radius:100%;content:'';height:10px;left:4px;position:absolute;top:6px;transition:transform 200ms;transform:scale(0);width:10px;}input[type="checkbox"]:checked + label:after{transform:scale(1);}.row{font-size:20px;margin:8px auto;text-align:right;width:144px;}.column-2{display:inline-block;padding:0 8px;}</style></head><body><noscript>Please enable JavaScript to play this game</noscript><table id="canvas-wrapper"><tbody><tr><td><canvas id="canvas" width="800" height="640"><table><caption>Sorry, your browser does not meet the minimum requirements for this game</caption><thead><tr><th>Browser</th><th>Oldest Supported Version</th></tr></thead><tbody><tr><td>Internet Explorer</td><td>9.0</td></tr><tr><td>Firefox</td><td>3.6</td></tr><tr><td>Chrome</td><td>4.0</td></tr><tr><td>Safari</td><td>4.0</td></tr><tr><td>Opera</td><td>10.1</td></tr></tbody></table></canvas></td><td class="controls"><input type="checkbox" name="mute" id="mute" checked><label for="mute">Mute Sounds</label><h1>Player 1: <span id="player-1-color"></span></h1><div class="row"><div class="column-2">Forward:</div><div class="column-2">&uarr;</div></div><div class="row"><div class="column-2">Left:</div><div class="column-2">&larr;</div></div><div class="row"><div class="column-2">Right:</div><div class="column-2">&rarr;</div></div><div class="row"><div class="column-2">Fire:</div><div class="column-2">&darr;</div></div><h1>Player 2: <span id="player-2-color"></span></h1><div class="row"><div class="column-2">Forward:</div><div class="column-2">W</div></div><div class="row"><div class="column-2">Left:</div><div class="column-2">A</div></div><div class="row"><div class="column-2">Right:</div><div class="column-2">D</div></div><div class="row"><div class="column-2">Fire:</div><div class="column-2">S</div></div></td></tr></tbody></table><canvas id="prerender" class="hide" width="800" height="640"></canvas></body><script type="text/javascript">const LEVELS=[[0,0,0,1,1,1,1,1,3,0,0,0,2,2,0,1,1,1,1,1,0,0,0,1,1,1,1,1,3,0,0,0,2,2,0,1,3,3,3,3,0,0,0,1,1,1,1,1,3,0,0,0,2,2,0,1,0,1,1,1,0,0,0,0,1,1,1,1,1,0,0,0,2,2,0,1,3,0,1,1,0,0,0,0,0,1,1,1,1,0,0,0,2,2,0,1,3,0,1,1,0,0,0,0,0,0,0,1,1,0,0,0,2,2,0,1,3,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,2,2,0,1,3,1,1,1,1,1,0,0,0,0,0,0,0,0,0,2,2,2,0,1,3,1,1,1,1,1,1,1,1,1,0,0,0,0,2,2,2,0,0,1,1,1,1,1,3,3,3,3,3,3,0,0,0,2,2,2,0,0,1,0,1,1,1,1,0,0,0,0,0,0,0,0,0,2,2,0,0,1,1,1,0,1,1,1,0,0,0,0,0,0,0,0,0,2,2,0,1,1,3,3,3,1,1,1,0,0,0,0,0,0,0,0,0,2,2,0,1,1,0,1,1,1,1,1,0,0,0,0,0,3,0,0,2,2,0,0,1,1,0,1,1,1,1,1,0,0,0,0,1,3,0,0,2,2,0,1,1,1,3,0,1,1,1,1,0,0,0,1,1,3,0,0,2,2,0,1,1,1,3,0,1,1,1,1,0,0,0,1,1,3,3,2,2,3,3,3,1,1,3,1,1,1,0,1,0,0,1,1,0,0,0,2,2,0,0,0,1,1,3,1,1,1,0,1,0,0,1,1,0,0,0,2,2,0,0,0,1,1,1,1,1,1,1,1,0,0,1,1,0,0,0,2,2,0,0,1,1,1,1,1,1,1,1,1],[0,0,0,1,1,1,0,0,0,1,1,2,2,2,2,2,2,2,2,2,0,0,1,1,1,1,1,0,0,1,1,2,2,2,2,2,2,2,2,2,0,1,1,1,1,1,0,0,0,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,1,0,0,0,0,0,1,1,2,2,2,2,2,2,2,2,1,1,1,1,1,1,0,0,0,0,1,1,1,2,2,2,2,2,2,2,1,1,1,1,1,0,0,0,0,0,0,1,1,2,2,2,2,2,2,2,0,0,1,1,0,0,0,0,0,0,0,1,1,1,2,2,2,2,2,2,0,0,0,0,0,0,0,0,3,0,0,0,1,1,1,1,2,2,2,2,0,0,0,0,0,0,0,0,3,0,0,0,0,0,1,1,1,1,1,2,0,0,0,0,0,0,0,0,3,0,0,0,0,0,0,0,1,1,1,1,0,0,0,3,3,3,3,3,3,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,3,3,3,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,3,0,0,0,0,0,0,0,2,2,1,1,1,1,1,1,0,0,0,0,3,0,0,0,0,0,0,0,2,2,2,2,2,1,1,1,1,0,0,0,3,0,0,0,1,1,1,0,2,2,2,2,2,2,1,1,1,0,0,0,3,0,0,1,0,1,1,1,2,2,2,2,2,2,2,1,1,1,0,0,3,0,0,1,1,1,1,1,2,2,2,2,2,2,2,1,1,1,0,0,0,0,1,1,1,1,1,0,2,2,2,2,2,2,2,2,1,1,0,0,0,0,1,1,1,1,1,0,2,2,2,2,2,2,2,2,1,1,1,0,0,0,1,1,1,1,0,0],[0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,3,3,1,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,1,1,1,0,0,0,0,1,1,1,1,1,1,1,3,3,0,0,0,1,1,1,0,0,2,2,0,0,3,1,1,1,1,1,1,3,0,0,1,1,1,0,0,2,2,2,2,2,3,3,3,3,1,1,1,3,1,0,1,1,0,0,0,2,2,2,2,2,2,2,2,3,1,1,1,3,1,1,1,0,0,0,2,2,2,2,2,2,2,2,2,2,2,1,1,3,1,1,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,0,1,1,1,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,0,1,1,1,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,0,0,1,1,1,0,0,3,3,0,0,3,3,3,3,2,2,2,0,0,0,0,1,1,1,0,0,0,3,0,0,1,1,1,3,0,0,0,0,0,0,0,1,1,1,0,0,0,3,0,0,0,0,1,3,0,0,0,0,0,0,0,1,1,1,0,0,0,3,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1],[0,0,0,0,0,1,1,1,1,1,1,3,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,3,1,1,1,1,1,0,0,1,0,0,1,1,1,1,1,3,1,1,1,3,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,3,1,1,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,0,0,3,0,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,0,3,3,3,3,3,3,3,3,3,3,0,1,1,1,1,1,1,1,1,1,3,0,0,0,0,0,0,0,0,3,3,3,3,1,1,3,3,1,1,1,3,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,1,1,0,3,0,0,3,0,0,3,0,0,0,1,1,1,1,1,1,1,1,1,1,3,0,0,3,0,0,3,0,0,3,1,1,1,1,1,1,1,1,1,1,3,0,0,3,0,0,3,0,0,3,0,1,1,1,1,1,1,1,1,1,0,0,0,3,0,0,3,0,0,3,1,1,1,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,3,1,1,1,3,3,1,1,3,3,3,3,0,0,0,0,0,0,0,0,3,0,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,0,1,1,1,1,1,1,1,1,1,1,0,1,0,1,1,3,1,0,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,0,1,1,1,0,1,1,1,3,1,1,1,3,1,1,1,1,1,1,0,0,1,1,1,1,1,1,1,3,1,1,2,2,2,1,1,1,0,0,0,0,1,1,1,1,1,1,1,3,1,2,2,2,2,2,1,1,0,0,0,0],[2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,0,0,1,1,1,1,1,1,1,1,1,1,3,1,1,1,1,1,3,2,0,0,1,1,1,1,1,1,1,1,1,1,3,1,1,1,1,1,3,3,1,1,3,3,3,3,3,3,3,3,1,1,3,1,1,3,1,1,3,3,1,1,3,1,1,3,1,1,1,1,1,1,3,1,1,3,1,1,3,3,1,1,3,1,1,3,1,1,1,1,1,1,1,1,1,3,1,1,3,3,1,1,3,1,1,3,1,1,1,1,1,1,1,1,1,3,1,1,3,3,1,1,3,1,1,3,1,1,3,3,3,3,3,1,1,3,1,1,3,3,1,1,1,1,1,3,1,1,1,1,1,1,3,1,1,3,1,1,3,3,1,1,1,1,1,3,1,1,1,1,1,1,3,1,1,3,1,1,3,3,1,1,3,3,3,3,3,1,1,3,3,3,3,3,3,3,3,3,3,3,1,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,1,1,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,1,1,3,1,1,3,3,3,3,3,3,1,1,3,3,3,1,1,3,3,1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,3,1,1,3,3,1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,3,1,1,3,3,3,3,3,1,1,3,3,3,1,1,3,3,3,3,3,3,1,1,3,3,1,1,1,1,1,3,1,1,1,1,1,1,1,1,1,1,0,0,2,3,1,1,1,1,1,3,1,1,1,1,1,1,1,1,1,1,0,0,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,2,2,2],[1,1,1,3,0,3,1,1,1,0,0,0,4,4,5,5,5,5,5,5,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,4,4,5,5,5,5,5,5,0,0,0,0,0,1,0,0,0,0,0,1,1,1,0,0,0,0,4,4,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,4,4,4,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,4,4,4,5,5,5,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,4,4,4,4,5,0,0,0,0,0,1,1,0,0,1,1,1,1,3,1,1,0,0,0,0,0,0,4,4,4,3,0,0,0,0,1,1,1,1,1,1,1,1,3,3,1,1,0,0,0,0,0,0,0,4,3,0,0,0,0,1,1,1,1,1,1,1,1,3,1,1,1,1,1,0,0,0,0,0,0,3,0,0,0,0,1,1,1,1,1,1,1,1,3,1,1,1,3,1,1,1,0,0,0,0,3,0,0,0,0,1,1,1,1,3,3,3,3,3,1,1,1,3,1,1,1,1,1,1,0,3,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,3,3,3,1,1,1,1,3,3,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,3,1,1,1,1,1,1,1,0,0,0,0,0,2,0,0,0,3,3,0,0,1,1,1,1,3,1,1,1,1,1,1,3,3,0,0,0,0,2,2,2,0,0,3,0,0,0,1,1,1,3,1,1,1,1,1,1,0,3,0,0,0,0,2,2,2,2,2,0,0,3,0,1,1,1,3,1,1,1,1,1,0,0,3,0,0,0,0,2,2,2,2,2,2,0,3,3,0,1,3,3,1,1,1,0,0,0,0,3,0,0,0,0,2,2,2,2,2,2,0,0,0,0,1,1,1,1,1,0,0,0,0,1,3,0,0,0,0,2,2,2,2,2,2,2,0,0,0,1,1,1,1,1,0,0,0,0,1,3,0,0,0,0,2,2,2,2,2,2,2,0,0,0,0,1,1,1,0,0,0,0,1,1,3,0,0,0,0],[4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,0,0,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,4,0,0,0,0,0,0,4,4,4,4,4,5,5,5,4,4,4,5,5,4,4,0,0,0,0,0,0,0,0,0,4,4,4,4,4,2,2,4,5,5,4,0,0,0,0,0,4,4,4,0,0,0,0,1,1,2,4,4,5,5,4,0,0,4,4,0,0,0,0,0,4,4,0,0,1,4,4,5,5,5,4,0,0,4,4,0,0,4,4,4,4,1,0,0,0,4,5,5,5,5,4,0,0,4,0,0,4,4,1,1,1,1,4,4,0,4,4,5,5,5,4,0,0,0,0,4,4,1,1,1,1,1,4,0,0,0,4,5,5,5,4,4,0,0,0,4,1,1,1,1,1,4,4,0,0,0,4,4,5,5,5,4,0,0,4,4,1,1,1,1,1,4,0,0,0,0,0,4,5,5,5,4,0,0,4,1,1,1,1,1,4,4,0,0,0,0,0,4,5,5,5,4,4,0,4,1,1,1,1,4,4,0,0,4,0,0,4,4,5,5,5,5,4,0,0,1,4,4,4,4,0,0,4,4,0,0,4,5,5,5,5,4,4,0,0,0,4,0,0,0,0,0,4,4,0,0,4,5,5,5,4,4,1,0,0,0,0,0,0,0,0,4,4,4,0,0,4,4,5,5,4,1,1,1,4,4,4,4,0,0,0,0,0,0,0,0,0,4,4,5,4,1,1,4,4,5,5,4,4,4,4,4,0,0,0,0,0,0,4,5,4,4,4,4,5,5,5,5,5,5,5,4,4,4,4,4,0,0,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,4,4,4,4]];const RANDOM=LEVELS.length;var level=LEVELS[0];var levelOption=0;var bubbles=[];function getTileIndex(e,t,l){return(e/32>>0)+(l==5?25:20)*(t/32>>0)}var scene="title";var frames=240;var round=1;var roundLimit=5;var cpuOption=0;var cpuSkill=0;var menu={delay:0,showLeft:1,showRight:1};var optionRow=0;const PALETTE=["#951","#791","#158","#722","#333","#C42"];const paletteNames=["Blue/Green","Red/Yellow","Green/Blue","Yellow/Red"];var paletteOption=0;const playerColors=[["#0AF","#0D2"],["#E04","#DE2"],["#0D2","#0AF"],["#DE2","#E04"]];var score=[0,0];var gKeys=[{},{}];var players=[{x:64,y:64,r:0,life:60,delay:0},{x:576,y:576,r:3.14,life:60,delay:0}];var trails=[[],[]];var cpuTargets=[{x:-1,y:-1},{x:-1,y:-1}];function renderTank(e,t,l){e.fillStyle=l;e.beginPath();e.moveTo(t.x+18*Math.cos(t.r+.17),t.y+18*Math.sin(t.r+.17));e.lineTo(t.x+9*Math.cos(t.r+.34),t.y+9*Math.sin(t.r+.34));e.lineTo(t.x+12*Math.cos(t.r+1),t.y+12*Math.sin(t.r+1));e.lineTo(t.x-14*Math.cos(t.r-.79),t.y-14*Math.sin(t.r-.79));e.lineTo(t.x-14*Math.cos(t.r+.79),t.y-14*Math.sin(t.r+.79));e.lineTo(t.x+12*Math.cos(t.r-1),t.y+12*Math.sin(t.r-1));e.lineTo(t.x+9*Math.cos(t.r-.34),t.y+9*Math.sin(t.r-.34));e.lineTo(t.x+18*Math.cos(t.r-.17),t.y+18*Math.sin(t.r-.17));e.closePath();e.fill()}function renderLevelPreview(e,t){if(t){let l=t.length>400;let r=0;for(let a=0;a<400;a++){if(l&&a>0&&a%20==0){r+=5}e.fillStyle=PALETTE[t[a+r]];e.fillRect(520+4*(a%20),450+4*(a/20>>0),4,4)}}else{e.strokeRect(520,450,80,80);e.fillText("?",560,504)}}function updateRoundLimit(e,t){e.clearRect(416,26,288,36);e.fillText(t,560,60)}function updatePlayerColors(e,t){let l=paletteNames[t].split("/");let r=document.getElementById("player-1-color");let a=document.getElementById("player-2-color");r.innerHTML=l[0];r.style.color=playerColors[t][0];a.innerHTML=l[1];a.style.color=playerColors[t][1];renderTank(e,{x:300,y:470,r:0},playerColors[t][0]);renderTank(e,{x:340,y:510,r:3.14},playerColors[t][1]);e.clearRect(416,116,288,40);e.fillStyle="#FFF";e.fillText(paletteNames[t],560,150)}function updateCPUOption(e,t){let l;switch(t){case 0:l="none";break;case 1:l="Player 1";break;case 2:l="Player 2";break;case 3:l="Both";break}e.clearRect(426,206,288,48);e.fillText(l,560,240)}function updateCPUSkill(e,t){e.clearRect(426,296,288,48);e.fillText(t+1,560,330)}function updateLevelOption(e,t){e.clearRect(416,386,288,36);e.fillText(t==RANDOM?"random":t+1,560,420);let l=LEVELS[t];e.clearRect(518,448,84,84);renderLevelPreview(e,l);e.fillStyle="#FFF"}function prerenderMenu(e,t,l,r,a,i){let n;switch(r){case 0:n="none";break;case 1:n="Player 1";break;case 2:n="Player 2";break;case 3:n="Both";break}let o=i==RANDOM?"random":i+1;let s=LEVELS[i];e.clearRect(0,0,800,640);e.fillStyle="#FFF";e.font="32px Courier";e.textAlign="center";e.fillText("Press spacebar to start",400,584);e.font="48px Courier";e.textAlign="right";e.fillText("Rounds:",320,60);e.fillText("Colors:",320,150);e.fillText("CPU:",320,240);e.fillText("CPU Skill:",320,330);e.fillText("Level:",320,420);e.textAlign="center";e.fillText(t,560,60);e.fillText(paletteNames[l],560,150);e.fillText(n,560,240);e.fillText(a+1,560,330);e.fillText(o,560,420);renderTank(e,{x:300,y:470,r:0},playerColors[l][0]);renderTank(e,{x:340,y:510,r:3.14},playerColors[l][1]);renderLevelPreview(e,s);e.fillStyle="#FFF"}function updateScore(e,t){e.clearRect(672,260,16,24);e.clearRect(672,364,16,24);e.textAlign="left";e.fillText(t[0],672,280);e.fillText(t[1],672,384)}function updateRound(e,t){e.clearRect(770,12,16,24);e.textAlign="right";e.fillText(t,784,32)}function prerenderLevel(e,t,l,r,a,i){e.clearRect(0,0,800,640);let n=l==5;let o=0;for(let l=0;l<400;l++){if(n&&l>0&&l%20==0){o+=5}e.fillStyle=PALETTE[t[l+o]];e.fillRect(32*(l%20),32*(l/20>>0),32,32)}e.font="24px Courier New";e.fillStyle="#FFF";e.textAlign="left";e.fillText("Round",656,32);e.fillText("of",672,64);e.fillText("Level",656,128);e.fillText(l==RANDOM?"random":l,672,160);e.fillText("Player 1",656,248);e.fillText(r[0],672,280);e.fillText("Player 2",656,352);e.fillText(r[1],672,384);e.textAlign="right";e.fillText(a,784,32);e.fillText(i,784,64)}function prerenderFinal(e,t,l){e.clearRect(0,0,800,640);e.fillStyle="#FFF";e.font="72px Courier";e.textAlign="center";e.fillText("Final Score",400,96);e.font="32px Courier";e.fillText("Press spacebar for new game",400,584);e.font="48px Courier";e.textAlign="right";e.fillText(t,368,176);e.fillText("Player 1:",464,352);e.fillText("Player 2:",464,448);e.textAlign="left";e.fillText(t>1?"Rounds":"Round",384,176);e.fillText(l[0],496,352);e.fillText(l[1],496,448)}var shells=[];function Shell(e,t){this.x=e.x+18*Math.cos(e.r);this.y=e.y+18*Math.sin(e.r);this.r=e.r;this.n=t;return this}Shell.prototype.life=128;function moveShell(e,t,l){let r=0;for(let a=0;a<8;a++){let a=Math.cos(t.r);let i=Math.sin(t.r);t.x+=a;t.y+=i;if(t.x<=2||e[t.n].x<640&&t.x>=638||t.x>=798){t.r=Math.atan2(i,-a);if(!r)r=1}if(t.y<=2||t.y>=638){t.r=Math.atan2(-i,a);if(!r)r=1}let n=getTileIndex(t.x,t.y,l);if(level[n]&&level[n]>2&&level[n]<5){let e=16-Math.abs(t.x%32-16)>>0;let l=16-Math.abs(t.y%32-16)>>0;if(e==l){t.r=Math.atan2(-i,-a);if(!r)r=1}else if(e<l){t.r=Math.atan2(i,-a);if(!r)r=1}else{t.r=Math.atan2(-i,a);if(!r)r=1}}}t.life--;return r}function shellCollidesWithPlayer(e,t){return t.life==60&&Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))<16}var audio;if(typeof AudioContext!=="undefined"){audio=new AudioContext}else if(webkitAudioContext){audio=new webkitAudioContext}else{console.error("AudioContext not available")}var mute=window.localStorage.getItem("mute")=="1";if(mute!=null){document.getElementById("mute").checked=mute;if(audio){audio.mute=mute}}else{toggleMute()}function toggleMute(){if(audio){audio.mute=document.getElementById("mute").checked;window.localStorage.setItem("mute",audio.mute?1:0);if(!audio.mute){playTone(0,.2)}}}document.getElementById("mute").addEventListener("change",toggleMute);function getKey(e){if(typeof e.key=="string"){return e.key}else{switch(e.keyCode){case 32:return" ";break;case 37:return"ArrowLeft";break;case 38:return"ArrowUp";break;case 39:return"ArrowRight";break;case 40:return"ArrowDown";break;case 97:return"a";break;case 100:return"d";break;case 115:return"s";break;case 119:return"w";break;case 192:return"`";break}}}function hkd(e){if(!e.altKey&&!e.ctrlKey&&!e.metaKey){e.preventDefault()}if(!e.repeat){let t=getKey(e);if(t=="`"){window.debug=!window.debug}switch(scene){case"menu":case"final":switch(t){case"ArrowLeft":menu.left=1;break;case"ArrowRight":menu.right=1;break;case"ArrowUp":menu.up=1;break;case"ArrowDown":menu.down=1;break;case" ":menu.start=1;break}break;case"game":if(cpuOption<3){switch(t){case"ArrowLeft":if(cpuOption!=1){gKeys[0].left=1};break;case"ArrowRight":if(cpuOption!=1){gKeys[0].right=1};break;case"ArrowUp":if(cpuOption!=1){gKeys[0].up=1};break;case"ArrowDown":if(cpuOption!=1){gKeys[0].fire=1};break;case"a":if(cpuOption<2){gKeys[1].left=1}break;case"d":if(cpuOption<2){gKeys[1].right=1}break;case"w":if(cpuOption<2){gKeys[1].up=1}break;case"s":if(cpuOption<2){gKeys[1].fire=1}break}}break;case"side":if(plr.life==60){switch(t){case"ArrowLeft":plr.xAcc--;break;case"ArrowRight":plr.xAcc++;break;case"ArrowUp":plr.yAcc--;break;case"ArrowDown":plr.yAcc++;break;case"a":plr.xDir--;break;case"d":plr.xDir++;break;case"w":plr.yDir--;break;case" ":if(plr.charge==0){plr.charge=1}break}if(plr.xDir||plr.yDir){plr.cTarget=Math.atan2(plr.yDir,plr.xDir);if(plr.cTarget>0){plr.cTarget-=6.28}}}break}}}function hku(e){let t=getKey(e);switch(scene){case"menu":case"final":switch(t){case"ArrowLeft":menu.left=0;break;case"ArrowRight":menu.right=0;break;case"ArrowUp":menu.up=0;break;case"ArrowDown":menu.down=0;break;case" ":menu.start=0;break}break;case"game":switch(t){case"ArrowLeft":gKeys[0].left=0;break;case"ArrowRight":gKeys[0].right=0;break;case"ArrowUp":gKeys[0].up=0;break;case"ArrowDown":gKeys[0].fire=0;break;case"a":gKeys[1].left=0;break;case"d":gKeys[1].right=0;break;case"w":gKeys[1].up=0;break;case"s":gKeys[1].fire=0;break}break;case"side":if(plr.life==60){switch(t){case"ArrowLeft":plr.xAcc++;break;case"ArrowRight":plr.xAcc--;break;case"ArrowUp":plr.yAcc++;break;case"ArrowDown":plr.yAcc--;break;case"a":plr.xDir++;break;case"d":plr.xDir--;break;case"w":plr.yDir++;break;case" ":shots.push(new Shot(plr));plr.charge=0;break}}break}}document.addEventListener("keydown",hkd);document.addEventListener("keyup",hku);function calculateGain(e,t,l){var r;switch(t){case"sine":r=l?4:2;break;case"triangle":r=l?5:2;break;case"sawtooth":r=l?20:5;break;case"square":r=l?22:6;break}return Math.pow(1.05,e/-20)/r}function stopSound(e,t){if(!audio||audio.mute){return null}let l=audio.currentTime;t.gain.setValueAtTime(t.gain.value,l);t.gain.linearRampToValueAtTime(0,l+.3);e.stop(l+.4);return null}function startTreadsSound(e){if(!audio||audio.mute){return{o:0,g:0}}let t=audio.currentTime;var l=audio.createOscillator();var r=audio.createGain();l.connect(r);r.connect(audio.destination);let a=e==0?110:74;l.frequency.value=a;l.type="triangle";let i=calculateGain(a,"triangle",true);r.gain.value=i;r.gain.setValueAtTime(0,t);r.gain.linearRampToValueAtTime(i,t+.1);l.start(t);return{o:l,g:r}}function startTurnSound(e){if(!audio||audio.mute){return{o:0,g:0}}let t=audio.currentTime;var l=audio.createOscillator();var r=audio.createGain();l.connect(r);r.connect(audio.destination);let a=e==0?220:148;l.frequency.value=a;l.type="triangle";let i=calculateGain(a,"triangle",true);r.gain.value=i;r.gain.setValueAtTime(0,t);r.gain.linearRampToValueAtTime(i,t+.1);l.start(t);return{o:l,g:r}}function playTone(e,t,l,r){if(!audio||audio.mute){return 0}let a=audio.currentTime+e;var i=audio.createOscillator();var n=audio.createGain();i.connect(n);n.connect(audio.destination);if(l){i.frequency.value=l}else{l=i.frequency.value}if(r){i.type=r}else{r=i.type}let o=calculateGain(l,r);n.gain.setValueAtTime(0,a);n.gain.linearRampToValueAtTime(o,a+.02);n.gain.linearRampToValueAtTime(0,a+t);i.start(a);i.stop(a+t)}function playFireSound(e){if(!audio||audio.mute){return 0}let t=audio.currentTime;var l=audio.createOscillator();var r=audio.createGain();l.connect(r);r.connect(audio.destination);let a=e==0?55:37;l.frequency.value=a;l.type="square";r.gain.setValueAtTime(calculateGain(a,"square"),t);r.gain.linearRampToValueAtTime(0,t+.2);l.start(t);l.stop(t+.2)}function playRicochetSound(e){if(!audio||audio.mute){return 0}let t=audio.currentTime;var l=audio.createOscillator();var r=audio.createGain();l.connect(r);r.connect(audio.destination);let a=e==0?220:148;l.frequency.value=a;l.type="square";r.gain.setValueAtTime(calculateGain(a,"square"),t);r.gain.linearRampToValueAtTime(0,t+.2);l.start(t);l.stop(t+.2)}function playExplodeSound(e){if(!audio||audio.mute){return 0}var t=audio.currentTime;var l=audio.createOscillator();var r=audio.createGain();l.connect(r);r.connect(audio.destination);let a=e==0?220:148;l.type="square";let i=calculateGain(a,"square");r.gain.setValueAtTime(i,t);r.gain.setValueAtTime(i,t+.3);r.gain.linearRampToValueAtTime(0,t+.4);l.frequency.setValueAtTime(a,t);l.frequency.exponentialRampToValueAtTime(a/4,t+.4);l.start(t);l.stop(t+.4)}var context=document.getElementById("canvas").getContext("2d");context.camera={x:0,y:0};context.fillStyle="#FFF";var prerender=document.getElementById("prerender");var preContext=prerender.getContext("2d");preContext.strokeStyle="#FFF";preContext.lineWidth=2;updateRoundLimit(preContext,roundLimit);updatePlayerColors(preContext,paletteOption);updateLevelOption(preContext,levelOption);function step(e){context.clearRect(0,0,800,640);switch(scene){case"title":context.fillStyle="#49C";context.fillRect(0,0,800,640);context.fillStyle="#FFF";context.fillRect(56,48,16,48);context.fillStyle="#FF0";context.fillRect(140,48,16,48);context.fillStyle="#0F0";context.fillRect(224,48,16,48);context.fillStyle="#0A0";context.fillRect(308,48,16,48);context.fillStyle="#FFF";context.fillRect(392,48,16,48);context.fillStyle="#CCA";context.fillRect(476,48,16,48);context.fillStyle="#F00";context.fillRect(560,48,16,48);context.fillStyle="#00F";context.fillRect(644,48,16,48);context.fillStyle="#000";context.fillRect(728,48,16,48);preContext.clearRect(0,0,800,640);preContext.font="48px Intellect,Courier,monospace";preContext.textAlign="center";preContext.fillStyle="#FFF";preContext.fillText("Peter  Wood",400,214);preContext.fillText("presents",400,258);preContext.fillText("TANKS  JS",400,416);preContext.fillText("Cpr  @  2017  PNW",400,592);context.drawImage(prerender,0,0,800,640,64,0,672,640);if(frames>0){frames--}else{scene="menu";context.fillStyle="#FFF";prerenderMenu(preContext,roundLimit,paletteOption,cpuOption,cpuSkill,levelOption)}break;case"menu":if(menu.delay==0){if(menu.start){scene="game";menu.start=0;if(levelOption==RANDOM){level=LEVELS[Math.random()*RANDOM>>0]}else{level=LEVELS[levelOption]}prerenderLevel(preContext,level,levelOption,score,round,roundLimit);let e=levelOption==5;for(let t=0;t<400;t++){if(level[t]==5){bubbles.push({x:32*(t%(e?25:20)),y:32*(t/(e?25:20)>>0),step:Math.random()*120>>0})}}}else{if(menu.up&&optionRow>0){optionRow--;playTone(0,.2,120,"triangle");playTone(0,.2,180,"triangle")}if(menu.down&&optionRow<4){optionRow++;playTone(0,.2,120,"triangle");playTone(0,.2,180,"triangle")}if(menu.left||menu.right){switch(optionRow){case 0:if(menu.left&&roundLimit>1){updateRoundLimit(preContext,roundLimit-=2);let e=100*(1+roundLimit/15);playTone(0,.2,e,"triangle");playTone(0,.2,1.33*e,"triangle")}if(menu.right&&roundLimit<15){updateRoundLimit(preContext,roundLimit+=2);let e=100*(1+roundLimit/15);playTone(0,.2,e,"triangle");playTone(0,.2,1.33*e,"triangle")}break;case 1:if(menu.left&&paletteOption>0){updatePlayerColors(preContext,--paletteOption);playTone(0,.2,150,"triangle");playTone(0,.2,200,"triangle")}if(menu.right&&paletteOption<3){updatePlayerColors(preContext,++paletteOption);playTone(0,.2,150,"triangle");playTone(0,.2,200,"triangle")}break;case 2:if(menu.left&&cpuOption>0){updateCPUOption(preContext,--cpuOption);playTone(0,.2,150,"triangle");playTone(0,.2,200,"triangle")}if(menu.right&&cpuOption<3){updateCPUOption(preContext,++cpuOption);playTone(0,.2,150,"triangle");playTone(0,.2,200,"triangle")}break;case 4:if(menu.left&&levelOption>0){updateLevelOption(preContext,--levelOption);playTone(0,.2,150,"triangle");playTone(0,.2,200,"triangle")}if(menu.right&&levelOption<RANDOM){updateLevelOption(preContext,++levelOption);playTone(0,.2,150,"triangle");playTone(0,.2,200,"triangle")}break}}if(menu.up||menu.down||menu.left||menu.right){switch(optionRow){case 0:if(roundLimit==1){if(menu.showLeft){menu.showLeft=0}}else if(!menu.showLeft){menu.showLeft=1}if(roundLimit==15){if(menu.showRight){menu.showRight=0}}else if(!menu.showRight){menu.showRight=1}break;case 1:if(paletteOption==0){if(menu.showLeft){menu.showLeft=0}}else if(!menu.showLeft){menu.showLeft=1}if(paletteOption==3){if(menu.showRight){menu.showRight=0}}else if(!menu.showRight){menu.showRight=1}break;case 2:if(cpuOption==0){if(menu.showLeft){menu.showLeft=0}}else if(!menu.showLeft){menu.showLeft=1}if(cpuOption==3){if(menu.showRight){menu.showRight=0}}else if(!menu.showRight){menu.showRight=1}break;case 3:if(menu.showLeft){menu.showLeft=0}if(menu.showRight){menu.showRight=0}break;case 4:if(levelOption==0){if(menu.showLeft){menu.showLeft=0}}else if(!menu.showLeft){menu.showLeft=1}if(levelOption==RANDOM){if(menu.showRight){menu.showRight=0}}else if(!menu.showRight){menu.showRight=1}break}menu.delay=20}}}context.drawImage(prerender,0,0);var t=45+90*optionRow;if(menu.showLeft){context.beginPath();context.moveTo(360,t);context.lineTo(400,t-30);context.lineTo(400,t+30);context.closePath();context.fill()}if(menu.showRight){context.beginPath();context.moveTo(760,t);context.lineTo(720,t-30);context.lineTo(720,t+30);context.closePath();context.fill()}if(menu.delay>0){menu.delay--}break;case"final":context.drawImage(prerender,0,0);if(menu.start){prerenderMenu(preContext,roundLimit,paletteOption,cpuOption,cpuSkill,levelOption);context.fillStyle="#FFF";scene="menu";menu.start=0;score=[0,0]}break;case"game":for(let e=0;e<2;e++){let t=players[e];let l=players[e^1];if(cpuOption>0){if(cpuOption==3||cpuOption==e+1){if(gKeys[e].fire){gKeys[e].fire=false}let r=0;switch(cpuSkill){case 0:let a=l.x-t.x;let i=l.y-t.y;let n=Math.sqrt(Math.pow(a,2)+Math.pow(i,2));let o=Math.atan2(i,a);if(o<0){o+=6.28}else if(o>=6.28){o-=6.28}let s=o-t.r;if(n<160){if(gKeys[e].up||cpuTargets[e].x>-1||cpuTargets[e].y>-1){gKeys[e].up=0;cpuTargets[e].x=-1;cpuTargets[e].y=-1}if(l.life==60&&t.delay==0){let r;let a=-2;let i=new Shell(t,e);while(a<cpuSkill&&!r&&i.life>0){if(moveShell(players,i,levelOption)){a++}if(shellCollidesWithPlayer(i,l)){r=1}else if(shellCollidesWithPlayer(i,t)){r=-1}}if(r>0){gKeys[e].fire=true}}if(s>3.14){r=-1}else if(s<-3.14){r=1}else if(s>.05){r=1}else if(s<-.05){r=-1}}else{let a=cpuTargets[e].x-t.x;let i=cpuTargets[e].y-t.y;if(a>-1&&a<1&&i>-1&&i<1||cpuTargets[e].x<0&&cpuTargets[e].y<0){if(gKeys[e].up){gKeys[e].up=0}let r=levelOption==5?25:20;let a=getTileIndex(t.x,t.y,levelOption);let i=level[a-1];let n=level[a+1];let o=level[a-r];let s=level[a+r];let u=level[a-1-r];let c=level[a+1-r];let f=level[a-1+r];let p=level[a+1+r];let y=[];if(typeof i=="number"&&i!=3&&i!=4&&a%r>0){y.push(a-1)}if(typeof n=="number"&&n!=3&&n!=4&&a%r<r-1){y.push(a+1)}if(typeof o=="number"&&o!=3&&o!=4&&a/r>=1){y.push(a-r)}if(typeof s=="number"&&s!=3&&s!=4&&a/r<20*(r-1)){y.push(a+r)}if(typeof u=="number"&&u!=3&&u!=4&&(a-1)%r>0){y.push(a-r-1)}if(typeof c=="number"&&c!=3&&c!=4&&(a+1)%r<r-1){y.push(a-r+1)}if(typeof f=="number"&&f!=3&&f!=4&&(a-1)/r>=1){y.push(a+r-1)}if(typeof p=="number"&&p!=3&&p!=4&&(a+1)/r<20*(r-1)){y.push(a+r+1)}let x;let d=Math.sqrt(Math.pow(l.x-t.x,2)+Math.pow(l.y-t.y,2));let h=1200;for(let e=0;e<8;e++){if(typeof y[0]=="number"){let t=32*(y[e]%r)+16;let a=32*(y[e]/r>>0)+16;let i=Math.sqrt(Math.pow(l.x-t,2)+Math.pow(l.y-a,2));if(i<d&&i<h){x=y[e];h=i}}}if(x){cpuTargets[e].x=32*(x%r)+16;cpuTargets[e].y=32*(x/r>>0)+16}else{cpuTargets[e].x=-1;cpuTargets[e].y=-1}}if(cpuTargets[e].x>-1&&cpuTargets[e].y>-1){let l=cpuTargets[e].x-t.x;let a=cpuTargets[e].y-t.y;let i=Math.sqrt(Math.pow(l,2)+Math.pow(a,2));let n=Math.atan2(a,l);if(n<0){n+=6.28}else if(n>=6.28){n-=6.28}let o=n-t.r;if(o>3.14){r=-1}else if(o<-3.14){r=1}else if(o>.05){r=1}else if(o<-.05){r=-1}else{t.r=n}if(r){if(gKeys[e].up){gKeys[e].up=0}}else if(!gKeys[e].up){gKeys[e].up=1}}}break}if(r>0){if(gKeys[e].left){gKeys[e].left=0}if(!gKeys[e].right){gKeys[e].right=1}}else if(r<0){if(!gKeys[e].left){gKeys[e].left=1}if(gKeys[e].right){gKeys[e].right=0}}else{if(gKeys[e].left){gKeys[e].left=0}if(gKeys[e].right){gKeys[e].right=0}}}}if(t.life<60){if(t.life>-30){t.life--}else{trails=[[],[]];if(round<roundLimit){updateRound(preContext,++round);shells=[];if(levelOption==RANDOM){level=LEVELS[Math.random()*RANDOM>>0]}if(players[0].treads){players[0].treads=stopSound(players[0].treads.o,players[0].treads.g)}if(players[1].treads){players[1].treads=stopSound(players[1].treads.o,players[1].treads.g)}if(players[0].turn){players[0].turn=stopSound(players[0].turn.o,players[0].turn.g)}if(players[1].turn){players[1].turn=stopSound(players[1].turn.o,players[1].turn.g)}players=[{x:64,y:64,r:0,life:60,delay:0},{x:576,y:576,r:3.14,life:60,delay:0}];gKeys[0]={};gKeys[1]={}}else{prerenderFinal(preContext,roundLimit,score);players[0].l=false;players[1].l=false;round=0;scene="final"}break}}else{let l=level[getTileIndex(t.x,t.y,levelOption)];if(gKeys[e].left){t.r-=.05;while(t.r<0){t.r+=6.28}while(t.r>=6.28){t.r-=6.28}if(!players[e].turn){players[e].turn=startTurnSound(e)}}else if(gKeys[e].right){t.r+=.05;while(t.r<0){t.r+=6.28}while(t.r>6.28){t.r-=6.28}if(!players[e].turn){players[e].turn=startTurnSound(e)}}else if(players[e].turn){players[e].turn=stopSound(players[e].turn.o,players[e].turn.g)}if(gKeys[e].up){if(!players[e].treads){players[e].treads=startTreadsSound(e)}if(l==5&&!players[e].l){players[e].l=true;trails[e]=[]}let r=Math.cos(t.r);let a=Math.sin(t.r);let i=l==2?1:2;let n=i*r+t.x;let o=i*a+t.y;let s=level[getTileIndex(16*r+t.x,16*a+t.y,levelOption)];if(n<16){t.x=16}else if(levelOption>4&&n>784){t.x=784}else if(levelOption<5&&n>624){t.x=624}else if(s<3||s>4){t.x=n}if(o<16){t.y=16}else if(o>624){t.y=624}else if(s<3||s>4){t.y=o}}else if(players[e].treads){players[e].treads=stopSound(players[e].treads.o,players[e].treads.g)}if(gKeys[e].fire&&t.delay==0){t.delay=60;shells.push(new Shell(t,e));playFireSound(e)}let r=true;let a=0;for(let l=0;l<8;l++){let i=trails[e][l];if(r){if(i){let e=Math.sqrt(Math.pow(t.x-i.x,2)+Math.pow(t.y-i.y,2));let l=t.r-i.r;if(e<18&&l>-1&&l<1){r=false}}}if(i){a++}}if(r){if(a==8){trails[e]=trails[e].slice(1)}trails[e].push({x:t.x,y:t.y,r:t.r})}if(t.delay>0){t.delay--}}}context.drawImage(prerender,0,0);if(levelOption>3){context.strokeStyle="#FE6";context.lineWidth=2;for(let e=0;e<400;e++){if(bubbles[e]){if(bubbles[e].step<90){context.beginPath();context.arc(bubbles[e].x+14,bubbles[e].y+10,5*(bubbles[e].step/90),0,6.28);context.stroke();context.closePath()}if(bubbles[e].step>=30){context.beginPath();context.arc(bubbles[e].x+8,bubbles[e].y+24,4*((bubbles[e].step-30)/90),0,6.28);context.stroke();context.closePath()}if(bubbles[e].step<30){context.beginPath();context.arc(bubbles[e].x+24,bubbles[e].y+20,4*((bubbles[e].step+60)/90),0,6.28);context.stroke();context.closePath()}else if(bubbles[e].step>=60){context.beginPath();context.arc(bubbles[e].x+24,bubbles[e].y+20,4*((bubbles[e].step-60)/90),0,6.28);context.stroke();context.closePath()}bubbles[e].step++;if(bubbles[e].step>120){bubbles[e].step=0}}else{break}}}for(let e=0;e<2;e++){let t=players[e];let l=[];let r=[];context.beginPath();context.strokeStyle=t.l?"rgba(223,32,16,0.75)":"rgba(32,16,0,0.6)";context.lineWidth=6;for(let t=0;t<8;t++){let a=trails[e][t];if(a){l.push(6*Math.cos(a.r+1.57));r.push(6*Math.sin(a.r+1.57));context[t==0?"moveTo":"lineTo"](a.x+l[t],a.y+r[t])}}context.stroke();context.closePath();context.beginPath();for(let t=0;t<8;t++){let a=trails[e][t];if(a){context[t==0?"moveTo":"lineTo"](a.x-l[t],a.y-r[t])}}context.stroke();context.closePath()}for(let e=0;e<2;e++){let t=players[e];let l=playerColors[paletteOption];if(t.life==60){renderTank(context,t,l[e])}else if(t.life>0){let r=(60-t.life)/3>>0;context.strokeStyle=l[e];context.lineWidth=2;context.beginPath();context.moveTo(t.x+r/4,t.y);context.arc(t.x,t.y,r/4,0,6.28);if(t.life>5){context.moveTo(t.x+r/2,t.y);context.arc(t.x,t.y,r/2,0,6.28)}if(t.life>15){context.moveTo(t.x+r,t.y);context.arc(t.x,t.y,r,0,6.28)}context.stroke()}}let e=[];for(let e=0;e<shells.length;e++){let t=shells[e];if(moveShell(players,t,levelOption)){playRicochetSound(t.n)}context.fillStyle=players[t.n].l?"#FAA":"#FFE";context.fillRect(t.x-2,t.y-2,4,4)}for(let t=0;t<shells.length;t++){let l=shells[t];for(let e=0;e<2;e++){if(shellCollidesWithPlayer(l,players[e])){if(players[t].treads){players[t].treads=stopSound(players[t].treads.o,players[t].treads.g)}if(players[t].turn){stopSound(players[t].turn.o,players[t].turn.g)}playExplodeSound(e);players[e].life--;score[e^1]++;l.life=0;updateScore(preContext,score)}}if(l.life>0){e.push(l)}}shells=e;break}if(!l){var l=e}if(e-l<2e3){window.requestAnimationFrame(step)}}window.requestAnimationFrame(step);</script></html>
